<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>Fablix</title>

    <link rel="icon" type="image/png" href="logo.png">
</head>
<body>
<!-- Top Bar -->
<nav class="navbar navbar-expand-lg" style="background: linear-gradient(135deg, #438DD3, #72B9CF);">
    <a class="navbar-brand" href="main_page.html" style="color: white;">Home</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="top20.html" style="color: white;">Top 20</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="results.html" style="color: white;">Results</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="checkout.html" style="color: white;">Checkout</a>
            </li>
        </ul>
        <!-- Search form -->
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Fulltext" aria-label="Title" id="searchTitle" style="width: 500px;">
            <button class="btn btn-outline-light my-2 my-sm-0" type="button" id="searchButton">Search</button>
        </form>
    </div>
</nav>

<div class="container mt-4">
    <!-- Browsing Section -->
    <div class="row">
        <!-- Genres Section -->
        <div class="col-md-12">
            <h3>Browse by Genre</h3>
            <ul id="genreList" class="list-inline">
                <!-- Genres will be dynamically inserted here -->
            </ul>
        </div>

        <!-- Titles Section -->
        <div class="col-md-12">
            <h3>Browse by Title</h3>
            <ul id="alphabetList" class="list-inline">
                <!-- Alphabetical list will be dynamically inserted here -->
            </ul>
        </div>
    </div>
</div>

<!-- Load jQuery and Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<!-- Run JS Scripting -->
<script>
    $(document).ready(function() {
        $.ajax({
            url: "api/main_page", // Calls the MainPageServlet
            method: "GET",
            dataType: "json",
            success: function(genres) {
                const genreList = $('#genreList'); // Select the genre list container
                genreList.empty(); // Clear any existing content

                genres.forEach(genre => {
                    const genreItem = $('<li class="list-inline-item"></li>');
                    genreItem.append(`<a href="results.html?genre=${encodeURIComponent(genre)}&moviesPerPage=25&sortBy=titleAscRatingAsc&pageNumber=1" class="btn btn-link">${genre}</a>`);
                    genreList.append(genreItem);
                });
            }
        });

        const alphabet = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
        const numbers = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];

        const generateAlphabetList = () => {
            const alphabetList = $('#alphabetList');

            alphabet.forEach(letter => {
                const alphabetItem = $('<li class="list-inline-item"></li>');
                alphabetItem.append(`<a href="results.html?prefix=${letter}&moviesPerPage=25&sortBy=titleAscRatingAsc&pageNumber=1" class="btn btn-link">${letter}</a>`);
                alphabetList.append(alphabetItem);
            });

            numbers.forEach(number => {
                const numberItem = $('<li class="list-inline-item"></li>');
                numberItem.append(`<a href="results.html?prefix=${number}&moviesPerPage=25&sortBy=titleAscRatingAsc&pageNumber=1" class="btn btn-link">${number}</a>`);
                alphabetList.append(numberItem);
            });

            const nonAlphanumericItem = $('<li class="list-inline-item"></li>');
            nonAlphanumericItem.append(`<a href="results.html?prefix=*&moviesPerPage=25&sortBy=titleAscRatingAsc&pageNumber=1" class="btn btn-link">*</a>`);
            alphabetList.append(nonAlphanumericItem);
        };

        generateAlphabetList();

        // $("#searchButton").click(function() {
        //     let title = $("#searchTitle").val();
        //     let year = $("#searchYear").val();
        //     let director = $("#searchDirector").val();
        //     let starsName = $("#searchStarsName").val();
        //
        //     let queryParams = new URLSearchParams();
        //     if (title) queryParams.append("title", title);
        //     if (year) queryParams.append("year", year);
        //     if (director) queryParams.append("director", director);
        //     if (starsName) queryParams.append("star", starsName);
        //     queryParams.append("moviesPerPage", "25");
        //     queryParams.append("sortBy", "titleAscRatingAsc");
        //     queryParams.append("pageNumber", "1");
        //
        //     window.location.href = "results.html?" + queryParams.toString();
        // });

        $("#searchButton").click(function() {
            let title = $("#searchTitle").val();

            let queryParams = new URLSearchParams();
            if (title) queryParams.append("title", title);
            queryParams.append("moviesPerPage", "25");
            queryParams.append("sortBy", "titleAscRatingAsc");
            queryParams.append("pageNumber", "1");

            window.location.href = "results.html?" + queryParams.toString();
        });
    });
</script>

</body>
</html>